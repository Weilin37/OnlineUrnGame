{"ast":null,"code":"// Leaflet.PixiOverlay\n// version: 1.8.1\n// author: Manuel Baclet <mbaclet@gmail.com>\n// license: MIT\n(function (factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD\n    define(['leaflet', 'pixi.js'], factory);\n  } else if (typeof module !== 'undefined') {\n    // Node/CommonJS\n    module.exports = factory(require('leaflet'), require('pixi.js'));\n  } else {\n    // Browser globals\n    if (typeof window.L === 'undefined') {\n      throw new Error('Leaflet must be loaded first');\n    }\n\n    if (typeof window.PIXI === 'undefined') {\n      throw new Error('Pixi.js must be loaded first');\n    }\n\n    factory(window.L, window.PIXI);\n  }\n})(function (L, PIXI) {\n  var round = L.Point.prototype._round;\n\n  var no_round = function () {\n    return this;\n  };\n\n  function setInteractionManager(interactionManager, destroyInteractionManager, autoPreventDefault) {\n    if (destroyInteractionManager) {\n      interactionManager.destroy();\n    } else if (!autoPreventDefault) {\n      interactionManager.autoPreventDefault = false;\n    }\n  }\n\n  var pixiOverlayClass = {\n    options: {\n      // @option padding: Number = 0.1\n      // How much to extend the clip area around the map view (relative to its size)\n      // e.g. 0.1 would be 10% of map view in each direction\n      padding: 0.1,\n      // @option forceCanvas: Boolean = false\n      // Force use of a 2d-canvas\n      forceCanvas: false,\n      // @option doubleBuffering: Boolean = false\n      // Help to prevent flicker when refreshing display on some devices (e.g. iOS devices)\n      // It is ignored if rendering is done with 2d-canvas\n      doubleBuffering: false,\n      // @option resolution: Number = 1\n      // Resolution of the renderer canvas\n      resolution: L.Browser.retina ? 2 : 1,\n      // @option projectionZoom(map: map): Number\n      // return the layer projection zoom level\n      projectionZoom: function (map) {\n        return (map.getMaxZoom() + map.getMinZoom()) / 2;\n      },\n      // @option destroyInteractionManager:  Boolean = false\n      // Destroy PIXI Interaction Manager\n      destroyInteractionManager: false,\n      // @option\n      // Customize PIXI Interaction Manager autoPreventDefault property\n      // This option is ignored if destroyInteractionManager is set\n      autoPreventDefault: true,\n      // @option resolution: Boolean = false\n      // Enables drawing buffer preservation\n      preserveDrawingBuffer: false,\n      // @option resolution: Boolean = true\n      // Clear the canvas before the new render pass\n      clearBeforeRender: true,\n      // @option shouldRedrawOnMove(e: moveEvent): Boolean\n      // filter move events that should trigger a layer redraw\n      shouldRedrawOnMove: function () {\n        return false;\n      }\n    },\n    initialize: function (drawCallback, pixiContainer, options) {\n      L.setOptions(this, options);\n      L.stamp(this);\n      this._drawCallback = drawCallback;\n      this._pixiContainer = pixiContainer;\n      this._rendererOptions = {\n        transparent: true,\n        resolution: this.options.resolution,\n        antialias: true,\n        forceCanvas: this.options.forceCanvas,\n        preserveDrawingBuffer: this.options.preserveDrawingBuffer,\n        clearBeforeRender: this.options.clearBeforeRender\n      };\n      this._doubleBuffering = PIXI.utils.isWebGLSupported() && !this.options.forceCanvas && this.options.doubleBuffering;\n    },\n    _setMap: function () {},\n    _setContainerStyle: function () {},\n    _addContainer: function () {\n      this.getPane().appendChild(this._container);\n    },\n    _setEvents: function () {},\n    onAdd: function (targetMap) {\n      this._setMap(targetMap);\n\n      if (!this._container) {\n        var container = this._container = L.DomUtil.create('div', 'leaflet-pixi-overlay');\n        container.style.position = 'absolute';\n        this._renderer = PIXI.autoDetectRenderer(this._rendererOptions);\n        setInteractionManager(this._renderer.plugins.interaction, this.options.destroyInteractionManager, this.options.autoPreventDefault);\n        container.appendChild(this._renderer.view);\n\n        if (this._zoomAnimated) {\n          L.DomUtil.addClass(container, 'leaflet-zoom-animated');\n\n          this._setContainerStyle();\n        }\n\n        if (this._doubleBuffering) {\n          this._auxRenderer = PIXI.autoDetectRenderer(this._rendererOptions);\n          setInteractionManager(this._auxRenderer.plugins.interaction, this.options.destroyInteractionManager, this.options.autoPreventDefault);\n          container.appendChild(this._auxRenderer.view);\n          this._renderer.view.style.position = 'absolute';\n          this._auxRenderer.view.style.position = 'absolute';\n        }\n      }\n\n      this._addContainer();\n\n      this._setEvents();\n\n      var map = this._map;\n      this._initialZoom = this.options.projectionZoom(map);\n      this._wgsOrigin = L.latLng([0, 0]);\n      this._wgsInitialShift = map.project(this._wgsOrigin, this._initialZoom);\n      this._mapInitialZoom = map.getZoom();\n\n      var _layer = this;\n\n      this.utils = {\n        latLngToLayerPoint: function (latLng, zoom) {\n          zoom = zoom === undefined ? _layer._initialZoom : zoom;\n          var projectedPoint = map.project(L.latLng(latLng), zoom);\n          return projectedPoint;\n        },\n        layerPointToLatLng: function (point, zoom) {\n          zoom = zoom === undefined ? _layer._initialZoom : zoom;\n          var projectedPoint = L.point(point);\n          return map.unproject(projectedPoint, zoom);\n        },\n        getScale: function (zoom) {\n          if (zoom === undefined) return map.getZoomScale(map.getZoom(), _layer._initialZoom);else return map.getZoomScale(zoom, _layer._initialZoom);\n        },\n        getRenderer: function () {\n          return _layer._renderer;\n        },\n        getContainer: function () {\n          return _layer._pixiContainer;\n        },\n        getMap: function () {\n          return _layer._map;\n        }\n      };\n\n      this._update({\n        type: 'add'\n      });\n    },\n    onRemove: function () {\n      L.DomUtil.remove(this._container);\n    },\n    getEvents: function () {\n      var events = {\n        zoom: this._onZoom,\n        move: this._onMove,\n        moveend: this._update\n      };\n\n      if (this._zoomAnimated) {\n        events.zoomanim = this._onAnimZoom;\n      }\n\n      return events;\n    },\n    _onZoom: function () {\n      this._updateTransform(this._map.getCenter(), this._map.getZoom());\n    },\n    _onAnimZoom: function (e) {\n      this._updateTransform(e.center, e.zoom);\n    },\n    _onMove: function (e) {\n      if (this.options.shouldRedrawOnMove(e)) {\n        this._update(e);\n      }\n    },\n    _updateTransform: function (center, zoom) {\n      var scale = this._map.getZoomScale(zoom, this._zoom),\n          viewHalf = this._map.getSize().multiplyBy(0.5 + this.options.padding),\n          currentCenterPoint = this._map.project(this._center, zoom),\n          topLeftOffset = viewHalf.multiplyBy(-scale).add(currentCenterPoint).subtract(this._map._getNewPixelOrigin(center, zoom));\n\n      if (L.Browser.any3d) {\n        L.DomUtil.setTransform(this._container, topLeftOffset, scale);\n      } else {\n        L.DomUtil.setPosition(this._container, topLeftOffset);\n      }\n    },\n    _redraw: function (offset, e) {\n      this._disableLeafletRounding();\n\n      var scale = this._map.getZoomScale(this._zoom, this._initialZoom),\n          shift = this._map.latLngToLayerPoint(this._wgsOrigin)._subtract(this._wgsInitialShift.multiplyBy(scale))._subtract(offset);\n\n      this._pixiContainer.scale.set(scale);\n\n      this._pixiContainer.position.set(shift.x, shift.y);\n\n      this._drawCallback(this.utils, e);\n\n      this._enableLeafletRounding();\n    },\n    _update: function (e) {\n      // is this really useful?\n      if (this._map._animatingZoom && this._bounds) {\n        return;\n      } // Update pixel bounds of renderer container\n\n\n      var p = this.options.padding,\n          mapSize = this._map.getSize(),\n          min = this._map.containerPointToLayerPoint(mapSize.multiplyBy(-p)).round();\n\n      this._bounds = new L.Bounds(min, min.add(mapSize.multiplyBy(1 + p * 2)).round());\n      this._center = this._map.getCenter();\n      this._zoom = this._map.getZoom();\n\n      if (this._doubleBuffering) {\n        var currentRenderer = this._renderer;\n        this._renderer = this._auxRenderer;\n        this._auxRenderer = currentRenderer;\n      }\n\n      var view = this._renderer.view;\n      var b = this._bounds,\n          container = this._container,\n          size = b.getSize();\n\n      if (!this._renderer.size || this._renderer.size.x !== size.x || this._renderer.size.y !== size.y) {\n        if (this._renderer.gl) {\n          this._renderer.resolution = this.options.resolution;\n\n          if (this._renderer.rootRenderTarget) {\n            this._renderer.rootRenderTarget.resolution = this.options.resolution;\n          }\n        }\n\n        this._renderer.resize(size.x, size.y);\n\n        view.style.width = size.x + 'px';\n        view.style.height = size.y + 'px';\n\n        if (this._renderer.gl) {\n          var gl = this._renderer.gl;\n\n          if (gl.drawingBufferWidth !== this._renderer.width) {\n            var resolution = this.options.resolution * gl.drawingBufferWidth / this._renderer.width;\n            this._renderer.resolution = resolution;\n\n            if (this._renderer.rootRenderTarget) {\n              this._renderer.rootRenderTarget.resolution = resolution;\n            }\n\n            this._renderer.resize(size.x, size.y);\n          }\n        }\n\n        this._renderer.size = size;\n      }\n\n      if (this._doubleBuffering) {\n        var self = this;\n        requestAnimationFrame(function () {\n          self._redraw(b.min, e);\n\n          self._renderer.gl.finish();\n\n          view.style.visibility = 'visible';\n          self._auxRenderer.view.style.visibility = 'hidden';\n          L.DomUtil.setPosition(container, b.min);\n        });\n      } else {\n        this._redraw(b.min, e);\n\n        L.DomUtil.setPosition(container, b.min);\n      }\n    },\n    _disableLeafletRounding: function () {\n      L.Point.prototype._round = no_round;\n    },\n    _enableLeafletRounding: function () {\n      L.Point.prototype._round = round;\n    },\n    redraw: function (data) {\n      if (this._map) {\n        this._disableLeafletRounding();\n\n        this._drawCallback(this.utils, data);\n\n        this._enableLeafletRounding();\n      }\n\n      return this;\n    }\n  };\n\n  if (L.version >= \"1\") {\n    L.PixiOverlay = L.Layer.extend(pixiOverlayClass);\n  } else {\n    // backport some leaflet@1.0.0 methods\n    L.Map.prototype.getZoomScale = function (toZoom, fromZoom) {\n      var crs = this.options.crs;\n      fromZoom = fromZoom === undefined ? this._zoom : fromZoom;\n      return crs.scale(toZoom) / crs.scale(fromZoom);\n    };\n\n    L.DomUtil.setTransform = function (el, offset, scale) {\n      var pos = offset || new L.Point(0, 0);\n      el.style[L.DomUtil.TRANSFORM] = (L.Browser.ie3d ? 'translate(' + pos.x + 'px,' + pos.y + 'px)' : 'translate3d(' + pos.x + 'px,' + pos.y + 'px,0)') + (scale ? ' scale(' + scale + ')' : '');\n    }; // patch pixiOverlayClass for leaflet@0.7.7\n\n\n    pixiOverlayClass.includes = L.Mixin.Events;\n\n    pixiOverlayClass.addTo = function (map) {\n      map.addLayer(this);\n      return this;\n    };\n\n    pixiOverlayClass._setMap = function (map) {\n      this._map = map;\n      this._zoomAnimated = map._zoomAnimated;\n    };\n\n    pixiOverlayClass._setContainerStyle = function () {\n      var self = this;\n      ['-webkit-transform-origin', '-ms-transform-origin', 'transform-origin'].forEach(function (property) {\n        self._container.style[property] = '0 0';\n      });\n    };\n\n    pixiOverlayClass._addContainer = function () {\n      this._map.getPanes()[this.options.pane || 'overlayPane'].appendChild(this._container);\n    };\n\n    pixiOverlayClass._setEvents = function () {\n      var events = this.getEvents();\n\n      for (var evt in events) {\n        this._map.on(evt, events[evt], this);\n      }\n    };\n\n    pixiOverlayClass.onRemove = function () {\n      this._map.getPanes()[this.options.pane || 'overlayPane'].removeChild(this._container);\n\n      var events = this.getEvents();\n\n      for (var evt in events) {\n        this._map.off(evt, events[evt], this);\n      }\n    };\n\n    L.PixiOverlay = L.Class.extend(pixiOverlayClass);\n  } // @factory L.pixiOverlay(drawCallback: function, pixiContainer: PIXI.Container, options?: L.PixiOverlay options)\n  // Creates a PixiOverlay with the given arguments.\n\n\n  L.pixiOverlay = function (drawCallback, pixiContainer, options) {\n    return L.Browser.canvas ? new L.PixiOverlay(drawCallback, pixiContainer, options) : null;\n  };\n});","map":{"version":3,"sources":["C:/Users/Weilin/Documents/GitHub/InsectTrade/app/client/node_modules/leaflet-pixi-overlay/L.PixiOverlay.js"],"names":["factory","define","amd","module","exports","require","window","L","Error","PIXI","round","Point","prototype","_round","no_round","setInteractionManager","interactionManager","destroyInteractionManager","autoPreventDefault","destroy","pixiOverlayClass","options","padding","forceCanvas","doubleBuffering","resolution","Browser","retina","projectionZoom","map","getMaxZoom","getMinZoom","preserveDrawingBuffer","clearBeforeRender","shouldRedrawOnMove","initialize","drawCallback","pixiContainer","setOptions","stamp","_drawCallback","_pixiContainer","_rendererOptions","transparent","antialias","_doubleBuffering","utils","isWebGLSupported","_setMap","_setContainerStyle","_addContainer","getPane","appendChild","_container","_setEvents","onAdd","targetMap","container","DomUtil","create","style","position","_renderer","autoDetectRenderer","plugins","interaction","view","_zoomAnimated","addClass","_auxRenderer","_map","_initialZoom","_wgsOrigin","latLng","_wgsInitialShift","project","_mapInitialZoom","getZoom","_layer","latLngToLayerPoint","zoom","undefined","projectedPoint","layerPointToLatLng","point","unproject","getScale","getZoomScale","getRenderer","getContainer","getMap","_update","type","onRemove","remove","getEvents","events","_onZoom","move","_onMove","moveend","zoomanim","_onAnimZoom","_updateTransform","getCenter","e","center","scale","_zoom","viewHalf","getSize","multiplyBy","currentCenterPoint","_center","topLeftOffset","add","subtract","_getNewPixelOrigin","any3d","setTransform","setPosition","_redraw","offset","_disableLeafletRounding","shift","_subtract","set","x","y","_enableLeafletRounding","_animatingZoom","_bounds","p","mapSize","min","containerPointToLayerPoint","Bounds","currentRenderer","b","size","gl","rootRenderTarget","resize","width","height","drawingBufferWidth","self","requestAnimationFrame","finish","visibility","redraw","data","version","PixiOverlay","Layer","extend","Map","toZoom","fromZoom","crs","el","pos","TRANSFORM","ie3d","includes","Mixin","Events","addTo","addLayer","forEach","property","getPanes","pane","evt","on","removeChild","off","Class","pixiOverlay","canvas"],"mappings":"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","sourcesContent":["// Leaflet.PixiOverlay\n// version: 1.8.1\n// author: Manuel Baclet <mbaclet@gmail.com>\n// license: MIT\n\n(function (factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\t// AMD\n\t\tdefine(['leaflet', 'pixi.js'], factory);\n\t} else if (typeof module !== 'undefined') {\n\t\t// Node/CommonJS\n\t\tmodule.exports = factory(require('leaflet'), require('pixi.js'));\n\t} else {\n\t\t// Browser globals\n\t\tif (typeof window.L === 'undefined') {\n\t\t\tthrow new Error('Leaflet must be loaded first');\n\t\t}\n\t\tif (typeof window.PIXI === 'undefined') {\n\t\t\tthrow new Error('Pixi.js must be loaded first');\n\t\t}\n\t\tfactory(window.L, window.PIXI);\n\t}\n}(function (L, PIXI) {\n\n\tvar round = L.Point.prototype._round;\n\tvar no_round = function () {return this;};\n\n\tfunction setInteractionManager(interactionManager, destroyInteractionManager, autoPreventDefault) {\n\t\tif (destroyInteractionManager) {\n\t\t\tinteractionManager.destroy();\n\t\t} else if (!autoPreventDefault) {\n\t\t\tinteractionManager.autoPreventDefault = false;\n\t\t}\n\t}\n\n\tvar pixiOverlayClass = {\n\n\t\toptions: {\n\t\t\t// @option padding: Number = 0.1\n\t\t\t// How much to extend the clip area around the map view (relative to its size)\n\t\t\t// e.g. 0.1 would be 10% of map view in each direction\n\t\t\tpadding: 0.1,\n\t\t\t// @option forceCanvas: Boolean = false\n\t\t\t// Force use of a 2d-canvas\n\t\t\tforceCanvas: false,\n\t\t\t// @option doubleBuffering: Boolean = false\n\t\t\t// Help to prevent flicker when refreshing display on some devices (e.g. iOS devices)\n\t\t\t// It is ignored if rendering is done with 2d-canvas\n\t\t\tdoubleBuffering: false,\n\t\t\t// @option resolution: Number = 1\n\t\t\t// Resolution of the renderer canvas\n\t\t\tresolution: L.Browser.retina ? 2 : 1,\n\t\t\t// @option projectionZoom(map: map): Number\n\t\t\t// return the layer projection zoom level\n\t\t\tprojectionZoom: function (map) {return (map.getMaxZoom() + map.getMinZoom()) / 2;},\n\t\t\t// @option destroyInteractionManager:  Boolean = false\n\t\t\t// Destroy PIXI Interaction Manager\n\t\t\tdestroyInteractionManager: false,\n\t\t\t// @option\n\t\t\t// Customize PIXI Interaction Manager autoPreventDefault property\n\t\t\t// This option is ignored if destroyInteractionManager is set\n\t\t\tautoPreventDefault: true,\n\t\t\t// @option resolution: Boolean = false\n\t\t\t// Enables drawing buffer preservation\n\t\t\tpreserveDrawingBuffer: false,\n\t\t\t// @option resolution: Boolean = true\n\t\t\t// Clear the canvas before the new render pass\n\t\t\tclearBeforeRender: true,\n\t\t\t// @option shouldRedrawOnMove(e: moveEvent): Boolean\n\t\t\t// filter move events that should trigger a layer redraw\n\t\t\tshouldRedrawOnMove: function () {return false;},\n\t\t},\n\n\t\tinitialize: function (drawCallback, pixiContainer, options) {\n\t\t\tL.setOptions(this, options);\n\t\t\tL.stamp(this);\n\t\t\tthis._drawCallback = drawCallback;\n\t\t\tthis._pixiContainer = pixiContainer;\n\t\t\tthis._rendererOptions = {\n\t\t\t\ttransparent: true,\n\t\t\t\tresolution: this.options.resolution,\n\t\t\t\tantialias: true,\n\t\t\t\tforceCanvas: this.options.forceCanvas,\n\t\t\t\tpreserveDrawingBuffer: this.options.preserveDrawingBuffer,\n\t\t\t\tclearBeforeRender: this.options.clearBeforeRender\n\t\t\t};\n\t\t\tthis._doubleBuffering = PIXI.utils.isWebGLSupported() && !this.options.forceCanvas &&\n\t\t\t\tthis.options.doubleBuffering;\n\t\t},\n\n\t\t_setMap: function () {},\n\n\t\t_setContainerStyle: function () {},\n\n\t\t_addContainer: function () {\n\t\t\tthis.getPane().appendChild(this._container);\n\t\t},\n\n\t\t_setEvents: function () {},\n\n\t\tonAdd: function (targetMap) {\n\t\t\tthis._setMap(targetMap);\n\t\t\tif (!this._container) {\n\t\t\t\tvar container = this._container = L.DomUtil.create('div', 'leaflet-pixi-overlay');\n\t\t\t\tcontainer.style.position = 'absolute';\n\t\t\t\tthis._renderer = PIXI.autoDetectRenderer(this._rendererOptions);\n\t\t\t\tsetInteractionManager(\n\t\t\t\t\tthis._renderer.plugins.interaction,\n\t\t\t\t\tthis.options.destroyInteractionManager,\n\t\t\t\t\tthis.options.autoPreventDefault\n\t\t\t\t);\n\t\t\t\tcontainer.appendChild(this._renderer.view);\n\t\t\t\tif (this._zoomAnimated) {\n\t\t\t\t\tL.DomUtil.addClass(container, 'leaflet-zoom-animated');\n\t\t\t\t\tthis._setContainerStyle();\n\t\t\t\t}\n\t\t\t\tif (this._doubleBuffering) {\n\t\t\t\t\tthis._auxRenderer = PIXI.autoDetectRenderer(this._rendererOptions);\n\t\t\t\t\tsetInteractionManager(\n\t\t\t\t\t\tthis._auxRenderer.plugins.interaction,\n\t\t\t\t\t\tthis.options.destroyInteractionManager,\n\t\t\t\t\t\tthis.options.autoPreventDefault\n\t\t\t\t\t);\n\t\t\t\t\tcontainer.appendChild(this._auxRenderer.view);\n\t\t\t\t\tthis._renderer.view.style.position = 'absolute';\n\t\t\t\t\tthis._auxRenderer.view.style.position = 'absolute';\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._addContainer();\n\t\t\tthis._setEvents();\n\n\t\t\tvar map = this._map;\n\t\t\tthis._initialZoom = this.options.projectionZoom(map);\n\t\t\tthis._wgsOrigin = L.latLng([0, 0]);\n\t\t\tthis._wgsInitialShift = map.project(this._wgsOrigin, this._initialZoom);\n\t\t\tthis._mapInitialZoom = map.getZoom();\n\t\t\tvar _layer = this;\n\n\t\t\tthis.utils = {\n\t\t\t\tlatLngToLayerPoint: function (latLng, zoom) {\n\t\t\t\t\tzoom = (zoom === undefined) ? _layer._initialZoom : zoom;\n\t\t\t\t\tvar projectedPoint = map.project(L.latLng(latLng), zoom);\n\t\t\t\t\treturn projectedPoint;\n\t\t\t\t},\n\t\t\t\tlayerPointToLatLng: function (point, zoom) {\n\t\t\t\t\tzoom = (zoom === undefined) ? _layer._initialZoom : zoom;\n\t\t\t\t\tvar projectedPoint = L.point(point);\n\t\t\t\t\treturn map.unproject(projectedPoint, zoom);\n\t\t\t\t},\n\t\t\t\tgetScale: function (zoom) {\n\t\t\t\t\tif (zoom === undefined) return map.getZoomScale(map.getZoom(), _layer._initialZoom);\n\t\t\t\t\telse return map.getZoomScale(zoom, _layer._initialZoom);\n\t\t\t\t},\n\t\t\t\tgetRenderer: function () {\n\t\t\t\t\treturn _layer._renderer;\n\t\t\t\t},\n\t\t\t\tgetContainer: function () {\n\t\t\t\t\treturn _layer._pixiContainer;\n\t\t\t\t},\n\t\t\t\tgetMap: function () {\n\t\t\t\t\treturn _layer._map;\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._update({type: 'add'});\n\t\t},\n\n\t\tonRemove: function () {\n\t\t\tL.DomUtil.remove(this._container);\n\t\t},\n\n\t\tgetEvents: function () {\n\t\t\tvar events = {\n\t\t\t\tzoom: this._onZoom,\n\t\t\t\tmove: this._onMove,\n\t\t\t\tmoveend: this._update\n\t\t\t};\n\t\t\tif (this._zoomAnimated) {\n\t\t\t\tevents.zoomanim = this._onAnimZoom;\n\t\t\t}\n\t\t\treturn events;\n\t\t},\n\n\t\t_onZoom: function () {\n\t\t\tthis._updateTransform(this._map.getCenter(), this._map.getZoom());\n\t\t},\n\n\t\t_onAnimZoom: function (e) {\n\t\t\tthis._updateTransform(e.center, e.zoom);\n\t\t},\n\n\t\t_onMove: function(e) {\n\t\t\tif (this.options.shouldRedrawOnMove(e)) {\n\t\t\t\tthis._update(e);\n\t\t\t}\n\t\t},\n\n\t\t_updateTransform: function (center, zoom) {\n\t\t\tvar scale = this._map.getZoomScale(zoom, this._zoom),\n\t\t\t\tviewHalf = this._map.getSize().multiplyBy(0.5 + this.options.padding),\n\t\t\t\tcurrentCenterPoint = this._map.project(this._center, zoom),\n\n\t\t\t\ttopLeftOffset = viewHalf.multiplyBy(-scale).add(currentCenterPoint)\n\t\t\t\t\t.subtract(this._map._getNewPixelOrigin(center, zoom));\n\n\t\t\tif (L.Browser.any3d) {\n\t\t\t\tL.DomUtil.setTransform(this._container, topLeftOffset, scale);\n\t\t\t} else {\n\t\t\t\tL.DomUtil.setPosition(this._container, topLeftOffset);\n\t\t\t}\n\t\t},\n\n\t\t_redraw: function(offset, e) {\n\t\t\tthis._disableLeafletRounding();\n\t\t\tvar scale = this._map.getZoomScale(this._zoom, this._initialZoom),\n\t\t\t\tshift = this._map.latLngToLayerPoint(this._wgsOrigin)\n\t\t\t\t._subtract(this._wgsInitialShift.multiplyBy(scale))._subtract(offset);\n\t\t\tthis._pixiContainer.scale.set(scale);\n\t\t\tthis._pixiContainer.position.set(shift.x, shift.y);\n\t\t\tthis._drawCallback(this.utils, e);\n\t\t\tthis._enableLeafletRounding();\n\t\t},\n\n\t\t_update: function (e) {\n\t\t\t// is this really useful?\n\t\t\tif (this._map._animatingZoom && this._bounds) {return;}\n\n\t\t\t// Update pixel bounds of renderer container\n\t\t\tvar p = this.options.padding,\n\t\t\t\tmapSize = this._map.getSize(),\n\t\t\t\tmin = this._map.containerPointToLayerPoint(mapSize.multiplyBy(-p)).round();\n\n\t\t\tthis._bounds = new L.Bounds(min, min.add(mapSize.multiplyBy(1 + p * 2)).round());\n\t\t\tthis._center = this._map.getCenter();\n\t\t\tthis._zoom = this._map.getZoom();\n\n\t\t\tif (this._doubleBuffering) {\n\t\t\t\tvar currentRenderer = this._renderer;\n\t\t\t\tthis._renderer = this._auxRenderer;\n\t\t\t\tthis._auxRenderer = currentRenderer;\n\t\t\t}\n\n\t\t\tvar view = this._renderer.view;\n\t\t\tvar b = this._bounds,\n\t\t\t\tcontainer = this._container,\n\t\t\t\tsize = b.getSize();\n\n\t\t\tif (!this._renderer.size || this._renderer.size.x !== size.x || this._renderer.size.y !== size.y) {\n\t\t\t\tif (this._renderer.gl) {\n\t\t\t\t\tthis._renderer.resolution = this.options.resolution;\n\t\t\t\t\tif (this._renderer.rootRenderTarget) {\n\t\t\t\t\t\tthis._renderer.rootRenderTarget.resolution = this.options.resolution;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._renderer.resize(size.x, size.y);\n\t\t\t\tview.style.width = size.x + 'px';\n\t\t\t\tview.style.height = size.y + 'px';\n\t\t\t\tif (this._renderer.gl) {\n\t\t\t\t\tvar gl = this._renderer.gl;\n\t\t\t\t\tif (gl.drawingBufferWidth !== this._renderer.width) {\n\t\t\t\t\t\tvar resolution = this.options.resolution * gl.drawingBufferWidth / this._renderer.width;\n\t\t\t\t\t\tthis._renderer.resolution = resolution;\n\t\t\t\t\t\tif (this._renderer.rootRenderTarget) {\n\t\t\t\t\t\t\tthis._renderer.rootRenderTarget.resolution = resolution;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._renderer.resize(size.x, size.y);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._renderer.size = size;\n\t\t\t}\n\n\t\t\tif (this._doubleBuffering) {\n\t\t\t\tvar self = this;\n\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\tself._redraw(b.min, e);\n\t\t\t\t\tself._renderer.gl.finish();\n\t\t\t\t\tview.style.visibility = 'visible';\n\t\t\t\t\tself._auxRenderer.view.style.visibility = 'hidden';\n\t\t\t\t\tL.DomUtil.setPosition(container, b.min);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis._redraw(b.min, e);\n\t\t\t\tL.DomUtil.setPosition(container, b.min);\n\t\t\t}\n\t\t},\n\n\t\t_disableLeafletRounding: function () {\n\t\t\tL.Point.prototype._round = no_round;\n\t\t},\n\n\t\t_enableLeafletRounding: function () {\n\t\t\tL.Point.prototype._round = round;\n\t\t},\n\n\t\tredraw: function (data) {\n\t\t\tif (this._map) {\n\t\t\t\tthis._disableLeafletRounding();\n\t\t\t\tthis._drawCallback(this.utils, data);\n\t\t\t\tthis._enableLeafletRounding();\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\n\t};\n\n\tif (L.version >= \"1\") {\n\n\t\tL.PixiOverlay = L.Layer.extend(pixiOverlayClass);\n\n\t} else {\n\n\t\t// backport some leaflet@1.0.0 methods\n\t\tL.Map.prototype.getZoomScale = function (toZoom, fromZoom) {\n\t\t\tvar crs = this.options.crs;\n\t\t\tfromZoom = fromZoom === undefined ? this._zoom : fromZoom;\n\t\t\treturn crs.scale(toZoom) / crs.scale(fromZoom);\n\t\t};\n\n\t\tL.DomUtil.setTransform = function (el, offset, scale) {\n\t\t\tvar pos = offset || new L.Point(0, 0);\n\n\t\t\tel.style[L.DomUtil.TRANSFORM] =\n\t\t\t\t(L.Browser.ie3d ?\n\t\t\t\t\t'translate(' + pos.x + 'px,' + pos.y + 'px)' :\n\t\t\t\t\t'translate3d(' + pos.x + 'px,' + pos.y + 'px,0)') +\n\t\t\t\t(scale ? ' scale(' + scale + ')' : '');\n\t\t};\n\n\t\t// patch pixiOverlayClass for leaflet@0.7.7\n\t\tpixiOverlayClass.includes = L.Mixin.Events;\n\n\t\tpixiOverlayClass.addTo = function (map) {\n\t\t\tmap.addLayer(this);\n\t\t\treturn this;\n\t\t};\n\n\t\tpixiOverlayClass._setMap = function (map) {\n\t\t\tthis._map = map;\n\t\t\tthis._zoomAnimated = map._zoomAnimated;\n\t\t};\n\n\t\tpixiOverlayClass._setContainerStyle = function () {\n\t\t\tvar self = this;\n\t\t\t[\n\t\t\t\t'-webkit-transform-origin',\n\t\t\t\t'-ms-transform-origin',\n\t\t\t\t'transform-origin'\n\t\t\t].forEach(function (property) {\n\t\t\t\tself._container.style[property] = '0 0';\n\t\t\t});\n\t\t};\n\n\t\tpixiOverlayClass._addContainer = function () {\n\t\t\tthis._map.getPanes()[this.options.pane || 'overlayPane']\n\t\t\t\t.appendChild(this._container);\n\t\t};\n\n\t\tpixiOverlayClass._setEvents = function () {\n\t\t\tvar events = this.getEvents();\n\t\t\tfor (var evt in events) {\n\t\t\t\tthis._map.on(evt, events[evt], this);\n\t\t\t}\n\t\t};\n\n\t\tpixiOverlayClass.onRemove = function () {\n\t\t\tthis._map.getPanes()[this.options.pane || 'overlayPane']\n\t\t\t\t.removeChild(this._container);\n\t\t\tvar events = this.getEvents();\n\t\t\tfor (var evt in events) {\n\t\t\t\tthis._map.off(evt, events[evt], this);\n\t\t\t}\n\t\t};\n\n\t\tL.PixiOverlay = L.Class.extend(pixiOverlayClass);\n\n\t}\n\n\t// @factory L.pixiOverlay(drawCallback: function, pixiContainer: PIXI.Container, options?: L.PixiOverlay options)\n\t// Creates a PixiOverlay with the given arguments.\n\tL.pixiOverlay = function (drawCallback, pixiContainer, options) {\n\t\treturn L.Browser.canvas ? new L.PixiOverlay(drawCallback, pixiContainer, options) : null;\n\t};\n\n}));\n"]},"metadata":{},"sourceType":"script"}